#!/usr/bin/env bash

function hide_soft_keyboard() {
  local DIR="/system/bin"
  local loname="alrc-termux"
  [[ ! "${PATH//:/ }" =~ "$DIR" ]] && return 127
  local self=${FUNCNAME[0]}
  local detect_soft_keyboard detect_hard_keyboard;
  declare -A detect_soft_keyboard=([id]="Pilih metode masukan" [en]="Choose input method");
  declare -A detect_hard_keyboard=([id]="Mengonfigurasi keyboard fisik" [en]="Configure physical keyboard")
  local hard_key_string="Your using external keyboard"
    termux-reload-settings

  local if_input_soft_id=$(termux-notification-list | grep "${detect_soft_keyboard[id]}" | awk '{gsub("title", ""); print $0 " "}' | sed 's/[":,]//g' | xargs)
  local if_input_soft_en=$(termux-notification-list | grep "${detect_soft_keyboard[en]}" | awk '{gsub("title", ""); print $0 " "}' | sed 's/[":,]//g' | xargs)

    local if_input_hard_id=$(termux-notification-list | grep "${detect_hard_keyboard[id]}" | awk '{gsub("title", ""); print $0 " "}' | sed 's/[":,]//g' | xargs)
    local if_input_hard_en=$(termux-notification-list | grep "${detect_hard_keyboard[en]}" | awk '{gsub("title", ""); print $0 " "}' | sed 's/[":,]//g' | xargs)

unset HISTSIZE

    if [ "$(termux-notification-list)" == "" ]; then
      echo -e "${loname}: Please grant the Access Notifications on your device."
      echo -e "fpath.${self} is function generated by ${loname}"
      return 1

    elif [ "${if_input_soft_id}" == "${detect_soft_keyboard[id]}" ] || [ "${if_input_soft_en}" == "${detect_soft_keyboard[en]}" ]; then
      input keyevent 4
      termux-reload-settings
      return 0

    elif [ "$if_input_hard_en" == "${detect_hard_keyboard[en]}" ] || [ "${if_input_hard_id}" == "${detect_hard_keyboard[id]}" ]; then
    echo -e "${loname}: ${hard_key_string}."
    termux-reload-settings
    return 0
  fi
}
declare -f -x hide_soft_keyboard
